# CursorX å®˜ç½‘æ›´æ–° - å¿«é€Ÿå¼€å§‹

## ğŸ¯ æœ€ç®€å•çš„éƒ¨ç½²æ–¹å¼ï¼ˆ3æ­¥å®Œæˆï¼‰

### ç¬¬1æ­¥ï¼šåˆ›å»º DMG å®‰è£…åŒ…

```bash
cd /Users/ymg/gitee/xcursor/xpoint
./create_dmg.sh
```

è¿™ä¼šè‡ªåŠ¨ï¼š
- âœ… ä» Xcode ç¼–è¯‘ç›®å½•å¤åˆ¶åº”ç”¨
- âœ… åˆ›å»º DMG å®‰è£…åŒ…
- âœ… ä¿å­˜åˆ° `CursorX-portal/downloads/` ç›®å½•
- âœ… æ˜¾ç¤ºæ–‡ä»¶å¤§å°ä¿¡æ¯

### ç¬¬2æ­¥ï¼šæ›´æ–° appcast.xml

æ‰“å¼€ `CursorX-portal/appcast.xml`ï¼Œæ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬ï¼Œæ›´æ–°æ–‡ä»¶å¤§å°ï¼š

```xml
<enclosure url="https://cursorx.app/downloads/CursorX-1.0.0.dmg"
           sparkle:version="1.0.0"
           sparkle:shortVersionString="1.0.0"
           length="13107200"  <!-- æ›¿æ¢ä¸ºå®é™…æ–‡ä»¶å¤§å° -->
           type="application/octet-stream"
           sparkle:edSignature="[å¾…ç”Ÿæˆç­¾å]"/>  <!-- æš‚æ—¶ä¿æŒè¿™æ · -->
```

ğŸ’¡ **æç¤ºï¼š** `create_dmg.sh` ä¼šæ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼Œç›´æ¥å¤åˆ¶å³å¯ã€‚

### ç¬¬3æ­¥ï¼šéƒ¨ç½²åˆ° GitHub

```bash
cd /Users/ymg/gitee/xcursor/xpoint/CursorX-portal
./deploy_update.sh 1.0.0
```

è¿™ä¼šè‡ªåŠ¨ï¼š
- âœ… æ·»åŠ æ–‡ä»¶åˆ° Git
- âœ… æäº¤æ›´æ”¹
- âœ… æ¨é€åˆ° GitHub
- âœ… è§¦å‘ GitHub Pages éƒ¨ç½²

## âœ… å®Œæˆï¼

ç­‰å¾… 1-2 åˆ†é’Ÿåï¼Œæ‚¨çš„æ›´æ–°å°±ä¼šç”Ÿæ•ˆã€‚

## ğŸ§ª æµ‹è¯•æ›´æ–°

### æ–¹æ³•1ï¼šä¸´æ—¶é™ä½ç‰ˆæœ¬å·æµ‹è¯•

1. æ‰“å¼€ `xpoint/Info.plist`
2. ä¿®æ”¹ç‰ˆæœ¬å·ï¼š
   ```xml
   <key>CFBundleShortVersionString</key>
   <string>0.9.0</string>  <!-- æ”¹ä¸ºä½äº 1.0.0 -->
   ```
3. é‡æ–°ç¼–è¯‘å¹¶è¿è¡Œåº”ç”¨
4. ç‚¹å‡»çŠ¶æ€æ  â†’ æ£€æŸ¥æ›´æ–°
5. åº”è¯¥èƒ½çœ‹åˆ° v1.0.0 çš„æ›´æ–°æç¤º

### æ–¹æ³•2ï¼šæ¸…é™¤ç¼“å­˜æµ‹è¯•

```bash
# æ¸…é™¤ Sparkle ç¼“å­˜
defaults delete com.ymg.xpoint SULastCheckTime
defaults delete com.ymg.xpoint SUSkippedVersion

# é‡å¯åº”ç”¨
killall xpoint
open /path/to/xpoint.app

# ç‚¹å‡»æ£€æŸ¥æ›´æ–°
```

## âš ï¸ å…³äºç­¾å

ç›®å‰ appcast.xml ä¸­çš„ç­¾åæ˜¯ `[å¾…ç”Ÿæˆç­¾å]`ï¼Œè¿™æ„å‘³ç€ï¼š

- âœ… **å¯ä»¥æ£€æµ‹åˆ°æ›´æ–°** - Sparkle ä¼šå‘ç°æ–°ç‰ˆæœ¬
- âŒ **æ— æ³•ä¸‹è½½å®‰è£…** - ç­¾åéªŒè¯ä¼šå¤±è´¥

### è¦å¯ç”¨å®Œæ•´åŠŸèƒ½ï¼Œéœ€è¦é…ç½®ç­¾åï¼š

1. **ç”Ÿæˆå¯†é’¥ï¼š**
   ```bash
   cd /Users/ymg/gitee/xcursor/xpoint
   ./generate_sparkle_keys.sh
   ```

2. **ç­¾å DMGï¼š**
   ```bash
   ./bin/sign_update CursorX-portal/downloads/CursorX-1.0.0.dmg eddsa_private_key.pem
   ```

3. **æ›´æ–° appcast.xmlï¼š**
   å°†ç”Ÿæˆçš„ç­¾åæ›¿æ¢ `[å¾…ç”Ÿæˆç­¾å]`

4. **é‡æ–°éƒ¨ç½²ï¼š**
   ```bash
   cd CursorX-portal
   ./deploy_update.sh 1.0.0
   ```

## ğŸ“‹ å½“å‰å¯ä»¥åšä»€ä¹ˆ

å³ä½¿æ²¡æœ‰é…ç½®ç­¾åï¼Œæ‚¨ç°åœ¨ä¹Ÿå¯ä»¥ï¼š

âœ… **æµ‹è¯•æ›´æ–°æ£€æŸ¥åŠŸèƒ½**
- åº”ç”¨èƒ½æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬
- çŠ¶æ€æ æ˜¾ç¤ºæ›´æ–°é€šçŸ¥
- å¯ä»¥æŸ¥çœ‹æ›´æ–°è¯¦æƒ…

âœ… **éªŒè¯éƒ¨ç½²æµç¨‹**
- appcast.xml æ­£ç¡®è§£æ
- ç‰ˆæœ¬å·æ­£ç¡®è¯†åˆ«
- æ›´æ–°å†…å®¹æ­£ç¡®æ˜¾ç¤º

âŒ **æš‚æ—¶æ— æ³•åšçš„**
- ä¸‹è½½æ›´æ–°åŒ…
- è‡ªåŠ¨å®‰è£…æ›´æ–°

## ğŸ¯ æ¨èæµç¨‹

### é˜¶æ®µ1ï¼šæµ‹è¯•åŸºç¡€åŠŸèƒ½ï¼ˆç°åœ¨ï¼‰
1. åˆ›å»º DMG
2. æ›´æ–° appcast.xml
3. éƒ¨ç½²åˆ° GitHub
4. æµ‹è¯•æ›´æ–°æ£€æµ‹

### é˜¶æ®µ2ï¼šé…ç½®ç­¾åï¼ˆåç»­ï¼‰
1. ç”Ÿæˆç­¾åå¯†é’¥
2. ç­¾å DMG æ–‡ä»¶
3. æ›´æ–° appcast.xml
4. æµ‹è¯•å®Œæ•´æµç¨‹

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æŸ¥çœ‹æ–‡ä»¶å¤§å°ï¼Ÿ
```bash
ls -l CursorX-portal/downloads/CursorX-1.0.0.dmg | awk '{print $5}'
```

### Q: å¦‚ä½•éªŒè¯ appcast.xml æ ¼å¼ï¼Ÿ
```bash
curl https://cursorx.app/appcast.xml
# æˆ–è€…åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
```

### Q: GitHub Pages éƒ¨ç½²éœ€è¦å¤šä¹…ï¼Ÿ
é€šå¸¸ 1-2 åˆ†é’Ÿï¼Œå¯ä»¥åœ¨ä»“åº“çš„ Actions æ ‡ç­¾æŸ¥çœ‹è¿›åº¦ã€‚

### Q: å¦‚ä½•æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼Ÿ
```bash
log stream --predicate 'process == "xpoint"' --level debug | grep Update
```

## ğŸ“ ä¸‹ä¸€æ­¥

å®ŒæˆåŸºç¡€éƒ¨ç½²åï¼Œå»ºè®®ï¼š
1. é˜…è¯» `å®˜ç½‘éƒ¨ç½²æŒ‡å—.md` äº†è§£è¯¦ç»†é…ç½®
2. é…ç½®ç­¾åä»¥å¯ç”¨å®Œæ•´åŠŸèƒ½
3. ä¼˜åŒ–æ›´æ–°ä½“éªŒå’Œé€šçŸ¥

---

**å¿«é€Ÿå‘½ä»¤å‚è€ƒï¼š**

```bash
# åˆ›å»º DMG
./create_dmg.sh

# éƒ¨ç½²æ›´æ–°
cd CursorX-portal && ./deploy_update.sh 1.0.0

# æµ‹è¯•æ›´æ–°
defaults delete com.ymg.xpoint SULastCheckTime && killall xpoint
```
